<launch>
  <arg name="corba_port" default="5809" />
  <node name="start_omninames" pkg="rtmbuild" type="start_omninames.sh" args="$(arg corba_port)" />

  <arg name="nameserver" default="localhost" />
  <env name="RTCTREE_NAMESERVERS" value="$(arg nameserver):$(arg corba_port)" />
  <arg name="openrtm_args" value='-o "corba.nameservers:$(arg nameserver):$(arg corba_port)" -o "naming.formats:%n.rtc" -o "logger.file_name:/tmp/rtc%p.log" ' />

  <!-- RTC Service Provider sample -->
  <node name="provider" pkg="openrtm_tools" type="MyServiceProviderComp"	args='$(arg openrtm_args)' output="screen" />
  <!-- RTC Service Consumet sample -->
  <node name="consumer" pkg="openrtm_tools" type="MyServiceConsumerComp"	args='$(arg openrtm_args)' output="screen" />

  <!-- RTC SeqIn/SeqOut sample -->
  <node name="seqin"  pkg="openrtm_tools" type="SeqInComp"	args='$(arg openrtm_args)' output="screen" />
  <node name="seqout" pkg="openrtm_tools" type="SeqOutComp"	args='$(arg openrtm_args) output="screen"' />

  <!-- BEGIN:openrtm connection -->
  <node name="rtmlaunch_py" pkg="openrtm_tools" type="rtmlaunch.py"
        args="--verbose $(find openrtm_tools)/test/test-rtmlaunch.test" output="screen" />
  <rtactivate component="MyServiceProvider0.rtc" />
  <rtactivate component="MyServiceConsumer0.rtc" />
  <rtconnect from="MyServiceProvider0.rtc:MyService"
	     to="MyServiceConsumer0.rtc:MyService"/>

  <rtactivate component="SequenceInComponent0.rtc" />
  <rtactivate component="SequenceOutComponent0.rtc" />
  <rtconnect from="SequenceInComponent0.rtc:Float"     to="SequenceOutComponent0.rtc:Float"    subscription_type="new"/>
  <rtconnect from="SequenceInComponent0.rtc:FloatSeq"  to="SequenceOutComponent0.rtc:FloatSeq" subscription_type="flush"/>
  <!-- END:openrtm connection -->

  <test test-name="rtmlaunch" pkg="openrtm_tools" type="test-rtmlaunch.py" retry="4" args="--corba_port=$(arg corba_port)" />
</launch>
