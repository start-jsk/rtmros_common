all: installed.rtshell

INSTALL_DIR = `rospack find openrtm`
FILENAME    = rtshell-3.0.0.tar.gz
TARBALL     = build/$(FILENAME)
TARBALL_URL = http://www.openrtm.org/pub/OpenRTM-aist/tools/1.0.0/$(FILENAME)
SOURCE_DIR  = build/rtshell-3.0.0
UNPACK_CMD  = tar xzf
MD5SUM_FILE = $(FILENAME).md5sum
TARBALL_PATCH = patch/rtcryo.patch patch/rtstodot.patch patch/fmt.patch
PYTHONDIR   = `python -c 'import sys; print "python%s"%sys.version[:3]'`
include $(shell rospack find mk)/download_unpack_build.mk

installed.rtshell: wiped.rtshell $(SOURCE_DIR)/unpacked
	cd $(SOURCE_DIR) && echo "y" | python ./setup.py build && echo "y" | python ./setup.py install --prefix=$(INSTALL_DIR)
	@bash -c 'echo -e "\e[1;32m;; add following lines to .bashrc to use rtshell\n;;\e[m"'
	@bash -c 'echo -e "\e[1;32m;; source ${CURDIR}/share/rtshell/shell_support\e[m"'
	touch installed.rtshell

clean:
	-cd $(SOURCE_DIR) && make clean

wipe: clean
	rm -fr installed.rtshell
	rm -fr $(SOURCE_DIR)
	rm -fr lib/$(PYTHONDIR)/site-packages/rtshell
	rm -fr lib/$(PYTHONDIR)/site-packages/rtshell-3.0.0-py2.6.egg-info

wiped.rtshell:  Makefile.openrtm-rtshell-1.0.0
	make -f Makefile.openrtm-rtshell-1.0.0 wipe
	touch wiped.rtshell

